---
title: "AI - Constraint Satisfaction Problem"
author: Benson Hsu
date: 2022-11-08
category: Jekyll
layout: post
tags: [ai, algorithm]
---

>Introduction to Artificial Intelligence Week 6 Notes
{: .block-warning }

### CSPs Introduction

*Constraint Satisfaction Problem* å…¶å®šç¾©ç‚ºä¸€çµ„ç‰©ä»¶ï¼Œè€Œé€™äº›ç‰©ä»¶éœ€è¦æ»¿è¶³ä¸€å®šçš„é™åˆ¶æˆ–æ¢ä»¶ï¼Œè€Œé€™å€‹å•é¡Œå¯èƒ½æœ‰å¾ˆå¤šçš„è§£ã€‚CSP å•é¡Œç¶“å¸¸è¡¨ç¾å‡ºé«˜è¤‡é›œæ€§ï¼Œéœ€è¦çµåˆå•Ÿç™¼å¼æœå°‹å’Œæœå°‹æ–¹æ³•ä¾†åœ¨ä¸€å€‹åˆç†çš„æ™‚é–“å…§è§£æ±ºå•é¡Œã€‚

ä¸»è¦è§£æ³•ï¼šé€šéè­˜åˆ¥é•åç´„æŸçš„è®Šé‡èˆ‡å€¼çš„çµ„åˆæ¶ˆé™¤å¤§è¦æ¨¡çš„æœç´¢ç©ºé–“ã€‚
- CSP related
    - Linear programming
    - Nonlinear progaramming
    - Numerical analysis
- CSP application
    - Operations research
    - Network flows
    - optimization problems

**CSP Define**  

å®šç¾©ä¸€å€‹ 3-tuple(X, D, C) å…¶ä¸­  
X = {X1, ..., Xn} Finite set of variables.  
D = {D1, ..., Dn} Nonempty domain of possible values for each variable.  
C = {C1, ..., Cn} Finite set of constraints, Each constraint Ci limits the values that variables can take.  

**Example**

Map coloring å°±æ˜¯ä¸€å€‹ç¶“å…¸çš„ CSPã€‚æ¯å€‹å€åŸŸå³æ˜¯è®Šæ•¸ï¼Œé¡è‰²ä¾¿æ˜¯å€¼åŸŸï¼Œç›¸é„°å€åŸŸé¡è‰²ä¸åŒæ˜¯ç´„æŸã€‚

å…¶ä¸­é—œæ–¼ Constraint å¯è¢«åŠƒåˆ†ç‚º:  
- unary constraint: åªç´„æŸå–®å€‹ variable çš„å–å€¼ã€‚å¦‚ SA ä¸èƒ½è¢«æŸ“æˆç¶ è‰²ã€‚
- binary constraint: å…©å€‹ variable ç›¸é—œçš„ç´„æŸã€‚å¦‚ SA ä¸èƒ½èˆ‡ WA çš„é¡è‰²ç›¸åŒã€‚
- global constraint: å…¨å±€ç´„æŸã€‚å¦‚ Alldiff, å³ç´„æŸä¸­æ‰€æœ‰ variable çš†éœ€å–ä¸åŒçš„å€¼ã€‚

![](https://github.com/Hotshot824/Hotshot824.github.io/blob/master/_image/ai_csp_1.jpg?raw=true){:height="80%" width="80%"}

**[Arc Consistency example]**

### Backtracking search for CSPs

å›æœ”æœç´¢ï¼Œç”¨æ–¼ DFS ä¸­ã€‚ä»–æ¯æ¬¡ç‚º Single variable é€²è¡Œå–å€¼ï¼Œç•¶æ²’æœ‰åˆæ³•çš„å€¼å¯çµ¦æŸå€‹ variable æ™‚å°±é€²è¡Œå›æœ”ã€‚
- ç‚ºä½¿ search è®Šçš„é«˜æ•ˆï¼Œé ˆè§£æ±ºä»¥ä¸‹å•é¡Œ:
    1. ä¸‹ä¸€æ­¥æ‡‰è©²çµ¦å“ªå€‹ variable å–å€¼? æŒ‰ç…§ä»€éº¼é †åºå–å€¼?
    2. æ¯æ­¥ search æ‡‰è©²åšæ€æ¨£çš„æ¨ç†?

**Variable select: Minimum remaining values (MRV)**

æœ€å°‘å‰©é¤˜å€¼å•Ÿç™¼å¼: é¸æ“‡*åˆæ³•å–å€¼æœ€å°‘çš„ variable* é–‹å§‹ã€‚é€™æ¨£é¸æ“‡çš„ variable å¯èƒ½å¾ˆå¿«åœ°å°è‡´å¤±æ•—ï¼Œå¾è€Œé€²è¡Œå›æœ”ã€‚
![](https://1.bp.blogspot.com/-T4GOGoV6rwY/VRj6JLmgOJI/AAAAAAAAnsA/XruZvjnw4RU/s1600/%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%2B2015-03-30%2B%E4%B8%8B%E5%8D%883.03.36.png){:height="50%" width="50%"}

**Degree heuristic**  
é„°æ¥åº¦å•Ÿç™¼å¼: *é¸æ“‡èˆ‡å…¶ä»–æœªå–å€¼ variable ç´„æŸæœ€å¤šçš„ variable* ä¾†è©¦åœ–é™ä½æœªä¾†å¯èƒ½çš„åˆ†æ”¯ã€‚  
![](https://3.bp.blogspot.com/-rjmvY3Vk-LM/VRj6PQz4BkI/AAAAAAAAnsI/AMLsxDX1e2I/s1600/%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%2B2015-03-30%2B%E4%B8%8B%E5%8D%883.03.14.png){:height="50%" width="50%"}

**Value order**  
Least constraining value (æœ€å°‘é™åˆ¶å€¼): é¸æ“‡ value æ™‚å„ªå…ˆé¸æ“‡çµ¦é„°å±… variable ç•™ä¸‹æœ€å¤šé¸æ“‡çš„åˆ†æ”¯ã€‚  

![](https://1.bp.blogspot.com/-TK2n4EuROlE/VRj6pJvBGHI/AAAAAAAAnsQ/OzilSPyBSxQ/s1600/%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%2B2015-03-30%2B%E4%B8%8B%E5%8D%883.25.58.png){:height="50%" width="50%"}


### Inference in CSPs

åœ¨ CSP å•é¡Œä¸­ï¼ŒAlgorithm å¯ä»¥é€²è¡Œæœç´¢ï¼Œä¹Ÿå¯ä»¥åš[ç´„æŸå‚³æ’­] (The constraint propagation) çš„æ¨ç†  

*ç´„æŸå‚³æ’­:* ä½¿ç”¨ç´„æŸä¾†æ¸›å°‘ä¸€å€‹ variable çš„åˆæ³•å–å€¼ç¯„åœï¼Œå¾è€Œå½±éŸ¿èˆ‡æ­¤ variable æœ‰ç´„æŸé—œä¿‚çš„å¦ä¸€å€‹ variable çš„å–å€¼ã€‚ *(å±€éƒ¨ç›¸å®¹æ€§)*

**Node Consistency (ç¯€é»ç›¸å®¹)**

Single variable (In CSP Single node) å€¼åŸŸä¸­çš„æ‰€æœ‰å–å€¼æ»¿è¶³ä»–çš„ unary constraint.

>if SA = NA = {Red, Blue, Green};  
SA != Blue, NA != Red, SA = {Green, Red}, NA = {Blue, Green};
{: .block-tip }

**Arc Consistency (å¼§ç›¸å®¹)**

CSP ä¸­æŸ variable range æ‰€æœ‰å–å€¼æ»¿è¶³è©² variable çš„æ‰€æœ‰ binary constraint.

æœ€å¸¸ç”¨çš„ç®—æ³•ç‚º AC-3, ç®—æ³•æµç¨‹å¤§è‡´å¦‚ä¸‹:
>1. Get all the constraint and turn each one into two arcs.  
    Expmale: A > B becomes A > B and B < A.
2. Add all the arcs to a queue.  
3. Repeat until the queue is empty:  
    3.1. Take the first arc (ğ‘¥, ğ‘¦), off the queue (dequeue).  
    3.2. For every value in the ğ‘¥ domain, there must be some value of the ğ‘¦ domain.  
    3.3. Make ğ‘¥ arc consistent with ğ‘¦. To do so, remove values from ğ‘¥ domain for which there is no possible corresponding value for ğ‘¦ domain.  
    3.4. If the ğ‘¥ domain has changed, add all arcs of the form (ğ‘˜, ğ‘¥) to the queue (enqueue). Here ğ‘˜ is another variable different from ğ‘¦ that has a relation to ğ‘¥.  
{: .block-tip }

**Forward Checking**

å‘å‰æª¢é©—æ˜¯æœ€ç°¡å–®çš„æ¨ç†å½¢å¼ï¼Œåªè¦ X variable è¢«è³¦å€¼äº†ï¼Œå°±å‘å‰æª¢é©—éç¨‹å°ä»–åš Arc Consistency. æª¢æŸ¥å°æ–¼æ¯å€‹é€šéç´„æŸèˆ‡ X ç›¸é—œçš„, æœªè³¦äºˆå€¼çš„ Y variable,
å¾ Y çš„ range ä¸­æ¶ˆå»èˆ‡ X ä¸ç›¸å®¹çš„å€¼ã€‚

> ##### NOTE
>
> å¾…æ›´æ–°
{: .block-tip }

<!-- - æˆ‘å€‘å°‡å„å€åŸŸå®šç¾©æˆè®Šæ•¸(Variables)
    - Variables : V={WA,NT,Q,NSW,V,SA,T}
- æ¯å€‹è®Šæ•¸çš„å€¼åŸŸ(Domains)
    - Domains : Di={red,green,blue}
- å°‡å€¼è³¦äºˆè®Šæ•¸æ™‚çš„é™åˆ¶(Constraints)ç›¸é„°å€åŸŸå¿…é ˆä¸åŒé¡è‰², WAâ‰ NT
    - (WA,NT)={(red,green),(red,blue),(green,red),â€¦}

![](https://slideplayer.com/slide/10791455/38/images/25/Minimum+remaining+values+%28MRV%29.jpg){:height="80%" width="80%"}

[ref]: https://mropengate.blogspot.com/2015/03/constraint-satisfaction-problems-csp.html -->

[ç´„æŸå‚³æ’­]: https://www.ibm.com/docs/zh-tw/icos/12.8.0.0?topic=constraints-constraint-propagation-algorithm
[Arc Consistency example]: https://medium.com/swlh/how-to-solve-constraint-satisfaction-problems-csps-with-ac-3-algorithm-in-python-f7a9be538cfe